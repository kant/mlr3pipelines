<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Google Site Verification -->
<meta name="google-site-verification" content="BrjL5fpoyHZu1rR8rwnnM2MBO3u3iIFB8NsmSuOsY84" />
<title>PipeOpColApply — mlr_pipeops_colapply • mlr3pipelines</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>
<meta property="og:title" content="PipeOpColApply — mlr_pipeops_colapply" />

<meta property="og:description" content="Applies a function to each column of a task. Use the affect_columns parameter inherited from
PipeOpTaskPreproc to limit the columns this function should be applied to. This can be used
for simple parameter transformations or type conversions (e.g. as.numeric).
The same function is applied during training and prediction. One important relationship for
machine learning preprocessing is that during the prediction phase, the preprocessing on each
data row should be independent of other rows. Therefore, the applicator function should always
return a vector / list where each result component only depends on the corresponding input component and
not on other components. As a rule of thumb, if the function f generates output different
from Vectorize(f), it is not a function that should be used for applicator." />

<meta property="og:image" content="https://mlr3pipelines.mlr-org.com/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




<link rel="icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
<link rel="apple-touch-icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html"></a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/comparison_mlr3pipelines_mlr_sklearn.html">Comparison to Other Packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mlr-org/mlr3pipelines">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PipeOpColApply</h1>
    <small>Source: <a href='https://github.com/mlr-org/mlr3pipelines/blob/master/R/PipeOpColApply.R'><code>R/PipeOpColApply.R</code></a></small>
    </div>

    
    <p>Applies a function to each column of a task. Use the <code>affect_columns</code> parameter inherited from
<code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code> to limit the columns this function should be applied to. This can be used
for simple parameter transformations or type conversions (e.g. <code>as.numeric</code>).</p>
<p>The same function is applied during training and prediction. One important relationship for
machine learning preprocessing is that during the prediction phase, the preprocessing on each
data row should be independent of other rows. Therefore, the <code>applicator</code> function should always
return a vector / list where each result component only depends on the corresponding input component and
not on other components. As a rule of thumb, if the function <code>f</code> generates output different
from <code><a href='https://www.rdocumentation.org/packages/base/topics/Vectorize'>Vectorize(f)</a></code>, it is not a function that should be used for <code>applicator</code>.</p>
    

        
    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p><code>R6Class</code> object inheriting from <code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code>/<code><a href='PipeOp.html'>PipeOp</a></code>.</p>
    
    <h2 class="hasAnchor" id="construction"><a class="anchor" href="#construction"></a>Construction</h2>

    <pre>PipeOpColApply$new(id = "colapply", param_vals = list())
</pre>
<ul>
<li><p><code>id</code> :: <code><a href='https://www.rdocumentation.org/packages/base/topics/character'>character(1)</a></code><br />
Identifier of resulting object, default <code>"colapply"</code>.</p></li>
<li><p><code>param_vals</code> :: named <code>list</code><br />
List of hyperparameter settings, overwriting the hyperparameter settings that would otherwise be set during construction. Default <code><a href='https://www.rdocumentation.org/packages/base/topics/list'>list()</a></code>.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="input-and-output-channels"><a class="anchor" href="#input-and-output-channels"></a>Input and Output Channels</h2>

    
    <p>Input and output channels are inherited from <code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code>.</p>
<p>The output is the input <code><a href='https://mlr3.mlr-org.com/reference/Task.html'>Task</a></code> with features changed according to the <code>applicator</code> parameter.</p>
    
    <h2 class="hasAnchor" id="state"><a class="anchor" href="#state"></a>State</h2>

    
    <p>The <code>$state</code> is a named <code>list</code> with the <code>$state</code> elements inherited from <code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code>, as well as:</p><ul>
<li><p><code>emptydt</code> :: <code>data.table</code><br />
An empty <code>data.table</code> with columns of names and types from <em>output</em> features after training. This is used
to produce a correct type conversion during prediction, even when the input has zero length and
<code>applicator</code> is therefore not called.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="parameters"><a class="anchor" href="#parameters"></a>Parameters</h2>

    
    <p>The parameters are the parameters inherited from <code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code>, as well as:</p><ul>
<li><p><code>applicator</code> :: <code>function</code><br />
Function to apply to each column of the task. The return value must have the
same length as the input, i.e. vectorize over the input. A typical example would be <code>as.numeric</code>.
Use <code><a href='https://www.rdocumentation.org/packages/base/topics/Vectorize'>Vectorize</a></code> to create a vectorizing function from any function that
ordinarily only takes one element input.<br />
The <code>applicator</code> is not called during prediction if the input task has no rows; instead the
types of affected features are changed to the result types of the <code>applicator</code> call during training.
Initialized to the <code><a href='https://www.rdocumentation.org/packages/base/topics/identity'>identity()</a></code>-function.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="internals"><a class="anchor" href="#internals"></a>Internals</h2>

    
    <p><code>PipeOpColApply</code> can not inherit from <code><a href='PipeOpTaskPreprocSimple.html'>PipeOpTaskPreprocSimple</a></code>, because if <code>applicator</code> is given
and the prediction data has 0 rows, then the resulting <code>data.table</code> does not know
what the column types should be. Column type conformity between training and prediction is enforced
by simply saving a copy of an empty <code>data.table</code> in the <code>$state$emptydt</code> slot.</p>
    
    <h2 class="hasAnchor" id="fields"><a class="anchor" href="#fields"></a>Fields</h2>

    
    <p>Only fields inherited from <code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code>/<code><a href='PipeOp.html'>PipeOp</a></code>.</p>
    
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
    <p>Only methods inherited from <code><a href='PipeOpTaskPreprocSimple.html'>PipeOpTaskPreprocSimple</a></code>/<code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code>/<code><a href='PipeOp.html'>PipeOp</a></code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other PipeOps: <code><a href='PipeOpEnsemble.html'>PipeOpEnsemble</a></code>,
  <code><a href='PipeOpTaskPreproc.html'>PipeOpTaskPreproc</a></code>, <code><a href='PipeOp.html'>PipeOp</a></code>,
  <code><a href='mlr_pipeops_branch.html'>mlr_pipeops_branch</a></code>,
  <code><a href='mlr_pipeops_chunk.html'>mlr_pipeops_chunk</a></code>,
  <code><a href='mlr_pipeops_classbalancing.html'>mlr_pipeops_classbalancing</a></code>,
  <code><a href='mlr_pipeops_classifavg.html'>mlr_pipeops_classifavg</a></code>,
  <code><a href='mlr_pipeops_copy.html'>mlr_pipeops_copy</a></code>,
  <code><a href='mlr_pipeops_encode.html'>mlr_pipeops_encode</a></code>,
  <code><a href='mlr_pipeops_featureunion.html'>mlr_pipeops_featureunion</a></code>,
  <code><a href='mlr_pipeops_filter.html'>mlr_pipeops_filter</a></code>,
  <code><a href='mlr_pipeops_impute.html'>mlr_pipeops_impute</a></code>,
  <code><a href='mlr_pipeops_learner.html'>mlr_pipeops_learner</a></code>,
  <code><a href='mlr_pipeops_mutate.html'>mlr_pipeops_mutate</a></code>,
  <code><a href='mlr_pipeops_nop.html'>mlr_pipeops_nop</a></code>,
  <code><a href='mlr_pipeops_pca.html'>mlr_pipeops_pca</a></code>,
  <code><a href='mlr_pipeops_regravg.html'>mlr_pipeops_regravg</a></code>,
  <code><a href='mlr_pipeops_scale.html'>mlr_pipeops_scale</a></code>,
  <code><a href='mlr_pipeops_select.html'>mlr_pipeops_select</a></code>,
  <code><a href='mlr_pipeops_subsample.html'>mlr_pipeops_subsample</a></code>,
  <code><a href='mlr_pipeops_unbranch.html'>mlr_pipeops_unbranch</a></code>,
  <code><a href='mlr_pipeops.html'>mlr_pipeops</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>mlr3</span>)

<span class='no'>task</span> <span class='kw'>=</span> <span class='fu'><a href='https://mlr3.mlr-org.com/reference/mlr_sugar.html'>tsk</a></span>(<span class='st'>"iris"</span>)
<span class='no'>poca</span> <span class='kw'>=</span> <span class='fu'><a href='po.html'>po</a></span>(<span class='st'>"colapply"</span>, <span class='kw'>applicator</span> <span class='kw'>=</span> <span class='no'>as.character</span>)
<span class='no'>poca</span>$<span class='fu'>train</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>task</span>))<span class='kw'>[[</span><span class='fl'>1</span>]]  <span class='co'># types are converted</span></div><div class='output co'>#&gt; &lt;TaskClassif:iris&gt; (150 x 5)
#&gt; * Target: Species
#&gt; * Properties: multiclass
#&gt; * Features (4):
#&gt;   - chr (4): Petal.Length, Petal.Width, Sepal.Length, Sepal.Width</div><div class='input'>
<span class='co'># function that does not vectorize</span>
<span class='no'>f</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
  <span class='co'># we could use `ifelse` here, but that is not the point</span>
  <span class='kw'>if</span> (<span class='no'>x</span> <span class='kw'>&gt;</span> <span class='fl'>1</span>) {
    <span class='st'>"a"</span>
  } <span class='kw'>else</span> {
    <span class='st'>"b"</span>
  }
}
<span class='no'>poca</span>$<span class='no'>param_set</span>$<span class='no'>values</span>$<span class='no'>applicator</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Vectorize'>Vectorize</a></span>(<span class='no'>f</span>)
<span class='no'>poca</span>$<span class='fu'>train</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>task</span>))<span class='kw'>[[</span><span class='fl'>1</span>]]$<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>()</div><div class='output co'>#&gt;        Species Petal.Length Petal.Width Sepal.Length Sepal.Width
#&gt;   1:    setosa            a           b            a           a
#&gt;   2:    setosa            a           b            a           a
#&gt;   3:    setosa            a           b            a           a
#&gt;   4:    setosa            a           b            a           a
#&gt;   5:    setosa            a           b            a           a
#&gt;  ---                                                            
#&gt; 146: virginica            a           a            a           a
#&gt; 147: virginica            a           a            a           a
#&gt; 148: virginica            a           a            a           a
#&gt; 149: virginica            a           a            a           a
#&gt; 150: virginica            a           a            a           a</div><div class='input'>
<span class='co'># only affect Petal.* columns:</span>
<span class='no'>poca</span>$<span class='no'>param_set</span>$<span class='no'>values</span>$<span class='no'>affect_columns</span> <span class='kw'>=</span> <span class='fu'><a href='Selector.html'>selector_grep</a></span>(<span class='st'>"^Petal"</span>)
<span class='no'>poca</span>$<span class='fu'>train</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>task</span>))<span class='kw'>[[</span><span class='fl'>1</span>]]$<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>()</div><div class='output co'>#&gt;        Species Petal.Length Petal.Width Sepal.Length Sepal.Width
#&gt;   1:    setosa            a           b          5.1         3.5
#&gt;   2:    setosa            a           b          4.9         3.0
#&gt;   3:    setosa            a           b          4.7         3.2
#&gt;   4:    setosa            a           b          4.6         3.1
#&gt;   5:    setosa            a           b          5.0         3.6
#&gt;  ---                                                            
#&gt; 146: virginica            a           a          6.7         3.0
#&gt; 147: virginica            a           a          6.3         2.5
#&gt; 148: virginica            a           a          6.5         3.0
#&gt; 149: virginica            a           a          6.2         3.4
#&gt; 150: virginica            a           a          5.9         3.0</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#format">Format</a></li>

      <li><a href="#construction">Construction</a></li>

      <li><a href="#input-and-output-channels">Input and Output Channels</a></li>

      <li><a href="#state">State</a></li>

      <li><a href="#parameters">Parameters</a></li>

      <li><a href="#internals">Internals</a></li>

      <li><a href="#fields">Fields</a></li>

      <li><a href="#methods">Methods</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <!--<div class="copyright">
  <p>Developed by Martin Binder, Florian Pfisterer, Bernd Bischl, Michel Lang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>
-->
      </footer>
   </div>

   

  </body>
</html>

